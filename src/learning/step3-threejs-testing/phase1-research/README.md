# Phase1 Research - Three.js Canvasæç”»ãƒ†ã‚¹ãƒˆæ‰‹æ³•èª¿æŸ»

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ã€Three.jsã®Canvasæç”»ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã‚’èª¿æŸ»ãƒ»PoCå®Ÿè£…ã™ã‚‹ãŸã‚ã®åŸºç›¤ç’°å¢ƒã§ã™ã€‚

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
phase1-research/
â”œâ”€â”€ poc/                     # PoCå®Ÿè£…
â”œâ”€â”€ docs/                    # èª¿æŸ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ utils/                   # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ components/              # ãƒ†ã‚¹ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ tests/                   # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ method1-dataurl/    # Method1: toDataURLæ‰‹æ³•
â”‚   â”œâ”€â”€ method2-readpixels/ # Method2: readPixelsæ‰‹æ³•
â”‚   â”œâ”€â”€ method3-rendertarget/ # Method3: RenderTargetæ‰‹æ³•
â”‚   â””â”€â”€ method4-visualregression/ # Method4: Visual Regressionæ‰‹æ³•
â”œâ”€â”€ benchmarks/              # æ€§èƒ½æ¸¬å®š
â”œâ”€â”€ package.json            # ä¾å­˜é–¢ä¿‚å®šç¾©
â”œâ”€â”€ jest.config.js          # Jestè¨­å®š
â”œâ”€â”€ types.ts               # åŒ…æ‹¬çš„å‹å®šç¾©
â”œâ”€â”€ constants.ts           # å…±é€šå®šæ•°
â””â”€â”€ README.md              # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶
- Node.js 18ä»¥ä¸Š
- npm 9ä»¥ä¸Š
- Three.js 0.163.0ä»¥ä¸Š

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
cd src/learning/step3-threejs-testing/phase1-research
npm install
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# åŸºæœ¬ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:watch

# è©³ç´°å‡ºåŠ›ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:verbose
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ§‹æˆ

### åŸºæœ¬å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ
- `tests/basic-verification.test.ts` - Jestç’°å¢ƒãƒ»DOMãƒ»CanvasåŸºæœ¬å‹•ä½œ
- `tests/threejs-import.test.ts` - Three.jsã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
- `tests/webgl-basic.test.ts` - WebGLã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåŸºæœ¬å‹•ä½œ

### Methodåˆ¥ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
å„æ‰‹æ³•å°‚ç”¨ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ï¼š
1. **Method1 (toDataURL)** - Canvas.toDataURL()ã«ã‚ˆã‚‹ç”»åƒå–å¾—
2. **Method2 (readPixels)** - WebGL.readPixels()ã«ã‚ˆã‚‹ç›´æ¥å–å¾—
3. **Method3 (RenderTarget)** - Three.js RenderTargetã«ã‚ˆã‚‹ã‚ªãƒ•ã‚¹ã‚¯ãƒªãƒ¼ãƒ³æç”»
4. **Method4 (Visual Regression)** - Puppeteer/Playwrightã«ã‚ˆã‚‹å›å¸°ãƒ†ã‚¹ãƒˆ

## ğŸ“š å‹å®šç¾©ã‚·ã‚¹ãƒ†ãƒ 

### types.ts
åŒ…æ‹¬çš„ãªå‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼š
- ãƒ†ã‚¹ãƒˆçµæœãƒ»ã‚¨ãƒ©ãƒ¼æƒ…å ±ã®åŸºæœ¬å‹
- Canvas/WebGLé–¢é€£è¨­å®šå‹
- Three.jsã‚·ãƒ¼ãƒ³ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šå‹
- å„Methodå°‚ç”¨è¨­å®šå‹
- æ¯”è¼ƒãƒ»åˆ†æçµæœå‹
- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ»ãƒ¬ãƒãƒ¼ãƒˆå‹

### constants.ts
å…±é€šå®šæ•°å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼š
- ãƒ†ã‚¹ãƒˆè¨­å®šå®šæ•°ï¼ˆã‚µã‚¤ã‚ºãƒ»è‰²ãƒ»è¨±å®¹èª¤å·®ï¼‰
- Three.jsè¨­å®šå®šæ•°ï¼ˆã‚«ãƒ¡ãƒ©ãƒ»ãƒ©ã‚¤ãƒˆãƒ»ã‚¸ã‚ªãƒ¡ãƒˆãƒªï¼‰
- Methodåˆ¥è¨­å®šå®šæ•°
- æ€§èƒ½ãƒ»ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å®šæ•°
- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å®šç¾©

## ğŸ”§ è¨­å®šè©³ç´°

### Jestè¨­å®š (jest.config.js)
- **ç’°å¢ƒ**: jsdom (ãƒ–ãƒ©ã‚¦ã‚¶APIæ¨¡æ“¬)
- **Mock**: Canvas/WebGLå®Œå…¨å¯¾å¿œ
- **Transform**: TypeScriptå¯¾å¿œ
- **Timeout**: 10ç§’

### WebGL/Canvas Mock
`jest.setup.js`ã§åŒ…æ‹¬çš„ãªMockå®Ÿè£…ï¼š
- Canvas 2D/WebGLã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
- WebGLãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ¡ã‚½ãƒƒãƒ‰
- DOM APIæ‹¡å¼µ

## ğŸ¯ ä¸»è¦æ©Ÿèƒ½

### 1. Mockç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆåŸºç›¤
- Canvas/WebGL APIã®å®Œå…¨Mock
- Three.jsã¨ã®çµ±åˆãƒ†ã‚¹ãƒˆç’°å¢ƒ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒ‡ãƒãƒƒã‚°æ”¯æ´

### 2. å‹å®‰å…¨ãªãƒ†ã‚¹ãƒˆé–‹ç™º
- TypeScriptå®Œå…¨å¯¾å¿œ
- åŒ…æ‹¬çš„ãªå‹å®šç¾©ã‚·ã‚¹ãƒ†ãƒ 
- IDEæ”¯æ´ãƒ»è‡ªå‹•è£œå®Œ

### 3. ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªæ§‹æˆ
- Methodåˆ¥åˆ†é›¢è¨­è¨ˆ
- å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ´»ç”¨
- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ»ãƒ¬ãƒãƒ¼ãƒˆçµ±åˆ

## âš ï¸ é‡è¦ãªåˆ¶ç´„äº‹é …

### canvasãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å•é¡Œ
Phase1ã§ã¯`canvas`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’é™¤å»æ¸ˆã¿ï¼š
- **ç†ç”±**: Node.js v23.11.0ã¨ã®äº’æ›æ€§å•é¡Œ
- **å¯¾å¿œ**: Mockç’°å¢ƒã§ã®é–‹ç™ºã«é›†ä¸­
- **å°†æ¥**: Phase2ä»¥é™ã§å®Ÿç’°å¢ƒå¯¾å¿œ

### ä¾å­˜é–¢ä¿‚æœ€é©åŒ–
å®Ÿæç”»ä¸è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’é™¤å»ï¼š
- `puppeteer`, `playwright` - Phase2ä»¥é™ã§è¿½åŠ 
- `pixelmatch`, `resemblejs` - Phase2ä»¥é™ã§è¿½åŠ 

## ğŸ”„ é–‹ç™ºãƒ•ãƒ­ãƒ¼

### Phase1: Mockç’°å¢ƒé–‹ç™º
1. åŸºæœ¬ç’°å¢ƒæ§‹ç¯‰ãƒ»å‹•ä½œç¢ºèª âœ…
2. æ–‡çŒ®èª¿æŸ»ãƒ»æ‰‹æ³•æ•´ç†
3. åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
4. Method1-4å€‹åˆ¥å®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆ
5. ç·åˆæ¯”è¼ƒãƒ»åˆ†æ
6. æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆãƒ»Phase2æº–å‚™

### æ¬¡ã‚¹ãƒ†ãƒƒãƒ—
- Issue #55-2: Canvasæç”»ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã®æ–‡çŒ®èª¿æŸ»
- Issue #55-3: åŸºæœ¬æ¤œè¨¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä½œæˆ
- Issue #55-4ã€œ55-7: Method1-4å®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆ
- Issue #55-8: æ€§èƒ½ãƒ»ç²¾åº¦ç·åˆæ¯”è¼ƒ
- Issue #55-9: æœ€çµ‚ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ

## ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### npm installå¤±æ•—
```bash
# node_moduleså‰Šé™¤ãƒ»å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules package-lock.json
npm install
```

### Jestå®Ÿè¡Œå¤±æ•—
```bash
# TypeScriptå‹ãƒã‚§ãƒƒã‚¯
npx tsc --noEmit types.ts constants.ts

# å€‹åˆ¥ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test -- tests/basic-verification.test.ts
```

### Three.jsã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼
- ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§Three.jsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã‹ç¢ºèª
- peerDependenciesã¨ã—ã¦è¨­å®šæ¸ˆã¿

## ğŸ‰ å®Œäº†çŠ¶æ³

### âœ… Phase1ç’°å¢ƒæ§‹ç¯‰å®Œäº†
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ä½œæˆ
- npm installæ­£å¸¸å‹•ä½œ
- Jestç’°å¢ƒæ§‹ç¯‰
- WebGL/Canvas Mockå®Ÿè£…
- TypeScriptå‹å®šç¾©ã‚·ã‚¹ãƒ†ãƒ 
- åŸºæœ¬ãƒ†ã‚¹ãƒˆå‹•ä½œç¢ºèª

**æ¬¡ã®Issueæº–å‚™å®Œäº†**: Issue #55-2ã€ŒCanvasæç”»ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã®æ–‡çŒ®èª¿æŸ»ã€
