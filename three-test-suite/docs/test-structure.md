# ãƒ†ã‚¹ãƒˆæ§‹é€ æ¦‚è¦

**Three.js ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ãƒ†ã‚¹ãƒˆæ§‹é€ ã¨ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚¬ã‚¤ãƒ‰**

## ğŸ¯ ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®ç›®çš„ã¨è¦–ç‚¹

### ğŸ“¦ å˜ä½“ãƒ†ã‚¹ãƒˆ (Unit Tests)

```
â”œâ”€â”€ å˜ä½“ãƒ†ã‚¹ãƒˆ (Unit Tests)
â”‚   â”œâ”€â”€ ğŸ¯ ç›®çš„: å€‹åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å‹•ä½œç¢ºèª
â”‚   â”œâ”€â”€ ğŸŒ å®Ÿè¡Œç’°å¢ƒ: Node.js / jsdom
â”‚   â”œâ”€â”€ ğŸ“ å¯¾è±¡: å„ã‚¯ãƒ©ã‚¹ãƒ»é–¢æ•°ã®ç‹¬ç«‹ã—ãŸå‹•ä½œ
â”‚   â””â”€â”€ ğŸ“Š ãƒ•ã‚¡ã‚¤ãƒ«æ•°: 8ãƒ•ã‚¡ã‚¤ãƒ«
```

**ãƒ†ã‚¹ãƒˆå¯¾è±¡ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«:**
- **BrowserManager**: ãƒ–ãƒ©ã‚¦ã‚¶ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç®¡ç†
- **EnvironmentInspector**: WebGLç’°å¢ƒæ¤œè¨¼
- **HTMLGenerator**: HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ
- **MockBrowserManager**: ãƒ¢ãƒƒã‚¯ãƒ–ãƒ©ã‚¦ã‚¶ç®¡ç†
- **PuppeteerManager**: Puppeteeræ“ä½œç®¡ç†
- **SceneInspector**: Three.jsã‚·ãƒ¼ãƒ³æ¤œè¨¼
- **TestUtils**: ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ©Ÿèƒ½
- **ThreeTestSuite**: ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ

### ğŸ”— çµåˆãƒ†ã‚¹ãƒˆ (Integration Tests)

```
â”œâ”€â”€ çµåˆãƒ†ã‚¹ãƒˆ (Integration Tests)
â”‚   â”œâ”€â”€ ğŸ¯ ç›®çš„: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®é€£æºç¢ºèª
â”‚   â”œâ”€â”€ ğŸŒ å®Ÿè¡Œç’°å¢ƒ: Node.js
â”‚   â”œâ”€â”€ ğŸ“ å¯¾è±¡: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®ç›¸äº’ä½œç”¨
â”‚   â””â”€â”€ ğŸ“Š ãƒ•ã‚¡ã‚¤ãƒ«æ•°: 1ãƒ•ã‚¡ã‚¤ãƒ«
```

**ãƒ†ã‚¹ãƒˆå¯¾è±¡:**
- **TestPatterns**: è¤‡æ•°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®çµ„ã¿åˆã‚ã›ãƒ‘ã‚¿ãƒ¼ãƒ³

### âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (Performance Tests)

```
â””â”€â”€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (Performance Tests)
    â”œâ”€â”€ ğŸ¯ ç›®çš„: å®Ÿè¡Œé€Ÿåº¦ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æ¸¬å®š
    â”œâ”€â”€ ğŸŒ å®Ÿè¡Œç’°å¢ƒ: Node.js
    â”œâ”€â”€ ğŸ“ å¯¾è±¡: å‡¦ç†é€Ÿåº¦ãƒ»ãƒªã‚½ãƒ¼ã‚¹åŠ¹ç‡æ€§
    â””â”€â”€ ğŸ“Š ãƒ•ã‚¡ã‚¤ãƒ«æ•°: 1ãƒ•ã‚¡ã‚¤ãƒ«
```

**ãƒ†ã‚¹ãƒˆå¯¾è±¡:**
- **PerformanceTester**: ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯æ€§èƒ½æ¸¬å®š

## ğŸš€ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã®ä½¿ã„åˆ†ã‘ã‚¬ã‚¤ãƒ‰

### ğŸ‘¨â€ğŸ’» é–‹ç™ºæ™‚ã®æ¨å¥¨ã‚³ãƒãƒ³ãƒ‰

```bash
# å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆæœ€ã‚‚é »ç¹ã«ä½¿ç”¨ï¼‰
npm run test:unit

# é–‹ç™ºä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ†ã‚¹ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚è‡ªå‹•å®Ÿè¡Œï¼‰
npm run test:watch

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚³ãƒŸãƒƒãƒˆå‰ã®ç¢ºèªï¼‰
npm test
```

### ğŸ¯ ç‰¹å®šæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

```bash
# Puppeteeré–¢é€£ãƒ†ã‚¹ãƒˆ
npm run test:puppeteer

# DOMé–¢é€£ãƒ†ã‚¹ãƒˆ
npm run test:dom

# çµåˆãƒ†ã‚¹ãƒˆ
npm run test:integration

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
npm run test:performance
```

### ğŸ­ CI/CDãƒ»å“è³ªä¿è¨¼

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆï¼ˆå“è³ªç¢ºèªï¼‰
npm run test:coverage

# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆCI/CDç’°å¢ƒï¼‰
npm test

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ
npm test -- BrowserManager.test.js
npm test -- __tests__/unit/PuppeteerManager.test.js
```

### ğŸ” ãƒ‡ãƒãƒƒã‚°ãƒ»é–‹ç™ºæ”¯æ´

```bash
# è©³ç´°ãƒ­ã‚°ä»˜ããƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test -- --verbose

# å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã®ã¿å†å®Ÿè¡Œ
npm test -- --onlyFailures

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®ã¿å®Ÿè¡Œ
npm test -- --testNamePattern="åˆæœŸåŒ–"
```

## âš™ï¸ Jestè¨­å®šã®æ¦‚è¦

### ğŸ—ï¸ 3ã¤ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```javascript
// jest.config.js ã®æ§‹é€ 
module.exports = {
  projects: [
    {
      displayName: 'unit',           // å˜ä½“ãƒ†ã‚¹ãƒˆ
      testMatch: ['**/__tests__/unit/**/*.test.js']
    },
    {
      displayName: 'integration',    // çµåˆãƒ†ã‚¹ãƒˆ  
      testMatch: ['**/__tests__/integration/**/*.test.js']
    },
    {
      displayName: 'performance',    // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
      testMatch: ['**/__tests__/performance/**/*.test.js']
    }
  ]
};
```

### ğŸ“‹ testMatchãƒ‘ã‚¿ãƒ¼ãƒ³ã®å½¹å‰²

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | å¯¾è±¡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª | å®Ÿè¡Œç’°å¢ƒ | ç”¨é€” |
|----------|----------------|----------|------|
| `**/__tests__/unit/**/*.test.js` | `__tests__/unit/` | Node.js + jsdom | å€‹åˆ¥æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ |
| `**/__tests__/integration/**/*.test.js` | `__tests__/integration/` | Node.js | ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é€£æºãƒ†ã‚¹ãƒˆ |
| `**/__tests__/performance/**/*.test.js` | `__tests__/performance/` | Node.js | æ€§èƒ½æ¸¬å®šãƒ†ã‚¹ãƒˆ |

### ğŸŒ ç’°å¢ƒåˆ¥å®Ÿè¡Œã®ä»•çµ„ã¿

```javascript
// å˜ä½“ãƒ†ã‚¹ãƒˆç’°å¢ƒè¨­å®šä¾‹
{
  testEnvironment: 'jsdom',        // DOMç’°å¢ƒã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
  setupFilesAfterEnv: ['./jest.setup.js'],
  collectCoverageFrom: [
    'src/**/*.js',
    '!src/**/*.test.js'
  ]
}

// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆç’°å¢ƒè¨­å®šä¾‹  
{
  testEnvironment: 'node',         // Node.jsç’°å¢ƒ
  testTimeout: 30000,              // é•·æ™‚é–“å®Ÿè¡Œã‚’è¨±å¯
  collectCoverage: false           // ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šã‚’ç„¡åŠ¹åŒ–
}
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®æµã‚Œ

### ğŸ”„ é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```
1. æ©Ÿèƒ½é–‹ç™º
   â†“
2. npm run test:unit        # å˜ä½“ãƒ†ã‚¹ãƒˆç¢ºèª
   â†“
3. npm run test:integration # çµåˆãƒ†ã‚¹ãƒˆç¢ºèª  
   â†“
4. npm run test:coverage    # ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèª
   â†“
5. npm test                 # å…¨ãƒ†ã‚¹ãƒˆæœ€çµ‚ç¢ºèª
   â†“
6. ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥
```

### âš¡ åŠ¹ç‡çš„ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# æ®µéšçš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆé–‹ç™ºä¸­ï¼‰
npm run test:unit           # é«˜é€Ÿï¼ˆ~10ç§’ï¼‰
npm run test:integration    # ä¸­é€Ÿï¼ˆ~30ç§’ï¼‰  
npm run test:performance    # ä½é€Ÿï¼ˆ~60ç§’ï¼‰

# åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆãƒªãƒªãƒ¼ã‚¹å‰ï¼‰
npm run test:coverage       # å…¨ãƒ†ã‚¹ãƒˆ + ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆ~2åˆ†ï¼‰
```

## ğŸ¨ ãƒ†ã‚¹ãƒˆã®ç‰¹å¾´

### ğŸ”§ æŠ€è¡“çš„ç‰¹å¾´

- **ç’°å¢ƒåˆ†é›¢**: å˜ä½“ãƒ»çµåˆãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã§ç•°ãªã‚‹å®Ÿè¡Œç’°å¢ƒ
- **é«˜é€ŸåŒ–**: ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®æœ€é©åŒ–ã•ã‚ŒãŸè¨­å®š
- **ç‹¬ç«‹æ€§**: ãƒ†ã‚¹ãƒˆé–“ã®ä¾å­˜é–¢ä¿‚ã‚’æ’é™¤
- **æ‹¡å¼µæ€§**: æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ—ã®è¿½åŠ ãŒå®¹æ˜“

### ğŸ“ˆ å“è³ªä¿è¨¼

- **ã‚«ãƒãƒ¬ãƒƒã‚¸**: ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ç¶²ç¾…æ€§æ¸¬å®š
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å‡¦ç†é€Ÿåº¦ã¨ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç›£è¦–  
- **å›å¸°é˜²æ­¢**: æ—¢å­˜æ©Ÿèƒ½ã®å‹•ä½œä¿è¨¼
- **CI/CDå¯¾å¿œ**: è‡ªå‹•åŒ–ã•ã‚ŒãŸç¶™ç¶šçš„ãƒ†ã‚¹ãƒˆ

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

è©³ç´°ãªå˜ä½“ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰ã«ã¤ã„ã¦ã¯ [`unit-tests-guide.md`](./unit-tests-guide.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ Three.js ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®ä¸€éƒ¨ã§ã™ã€‚*